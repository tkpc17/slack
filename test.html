<!DOCTYPE html><html>
<head>
<script language="JavaScript" type="text/javascript">
function loadXMLDoc(dname){
    if (window.XMLHttpRequest){
        xhttp=new XMLHttpRequest();
    }
    else {
        xhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xhttp.open("GET",dname,false);
    xhttp.overrideMimeType('text/xml');
    xhttp.send();
    return xhttp.responseXML;
} 
function searchXML(){
    input = document.getElementById("input").value;
    size = input.length;
    let date = new Date();
    if(size<11){
    		document.getElementById("results").innerHTML= "Waiting For a Valid UPC Scan..";
    		return false;
    }
    xmlDoc=loadXMLDoc("ppslack.xml");
    x=xmlDoc.getElementsByTagName("upc");
		for (i=0;i<x.length;i++){
      upc = xmlDoc.getElementsByTagName("upc")[i].childNodes[0].nodeValue;
      if (upc.toLowerCase() == input.toLowerCase()){
         	upc=xmlDoc.getElementsByTagName("upc")[i].childNodes[0].nodeValue;
          proddescription=xmlDoc.getElementsByTagName("description")[i].childNodes[0].nodeValue;
					shelflife=xmlDoc.getElementsByTagName("shelflife")[i].childNodes[0].nodeValue;
          document.getElementById("results").innerHTML= "<h1>Sell By: "+date.addDays(parseInt(shelflife))+"</h1><br /><table border=1><tr><th>UPC</th><th>Description</th><th>Days of Life</th></tr>" + "<tr><td>" + upc + "</td><td>" + proddescription + "</td><td>" + shelflife + "</td></tr>" + "</table>";
					document.getElementById('input').setSelectionRange(0, size);
          break;
      }
      else {
      	document.getElementById("results").innerHTML= "<h2>Barcode not in Slack Tool</h2>";
      	if(size>=11){
					setTimeout(() => {  document.getElementById('input').setSelectionRange(0, size); }, 3000);
				}	
      }
		}
    document.getElementById('input').focus();
}
Date.prototype.addDays = function (days) {
  let date = new Date(this.valueOf());
  date.setDate(date.getDate() + days);
  return date.toLocaleDateString();
}
</script>
</head>
<body>
<form>Scan Product: <input type="text" name="input" id="input" onkeyup="searchXML()" autofocus />
<script>
  if (!("autofocus" in document.createElement("input"))) {
    document.getElementById("input").focus();
  }
</script></form>
<div id="results">
</div>
</body>
</html>

